version: "3.8"
services:
  cloudflared:
    image: cloudflare/cloudflared
    container_name: cloudflare-tunnel
    restart: unless-stopped
    command:
      - tunnel
      - --no-autoupdate
      - run
      - --token
      - ${TUNNEL_TOKEN} 
    environment:
      - TUNNEL_TRANSPORT_PROTOCOL=http2
      - TUNNEL_EDGE_IP_VERSION=4
    networks: 
      - cloudflared_default
networks:
  cloudflared_default:
    external: true

secrets:
  cloudflareTunnelToken:
    external: true
